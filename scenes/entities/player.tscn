[gd_scene load_steps=49 format=3 uid="uid://c63k27ek72d3d"]

[ext_resource type="Script" path="res://scripts/entities/player/player.gd" id="1_30yaf"]
[ext_resource type="AudioStream" uid="uid://c7enblvm4yyws" path="res://audio/streams/voices/player/hups/hup_1.wav" id="2_ltik2"]
[ext_resource type="PackedScene" uid="uid://bimc4ufk5hicg" path="res://scenes/weapons/pump_shotgun.tscn" id="2_w8f7c"]
[ext_resource type="AudioStream" uid="uid://b6d0wnf3jecta" path="res://audio/streams/voices/player/hups/hup_2.wav" id="3_6ae3o"]
[ext_resource type="AudioStream" uid="uid://dyub7yfblkj1f" path="res://audio/streams/typewriter.wav" id="3_esyxp"]
[ext_resource type="AudioStream" uid="uid://be3e2ce82sum6" path="res://audio/streams/voices/player/hups/hup_11.wav" id="4_tvufw"]
[ext_resource type="AudioStream" uid="uid://cgm7r4b3kf36q" path="res://audio/streams/voices/player/hups/hup_12.wav" id="5_lnrhu"]
[ext_resource type="AudioStream" uid="uid://3nq08mhu7hgj" path="res://audio/streams/voices/player/hups/hup_13.wav" id="6_2r6q6"]
[ext_resource type="AudioStream" uid="uid://bmlxxe8maevqb" path="res://audio/streams/click.wav" id="6_3oqj4"]
[ext_resource type="Texture2D" uid="uid://c0bhiisq4qel1" path="res://textures/flashlight_projector.png" id="6_eocyj"]
[ext_resource type="PackedScene" uid="uid://dh4rwigqkk6va" path="res://scenes/ui/player_hud.tscn" id="6_tw0uv"]
[ext_resource type="AudioStream" uid="uid://b6hblfi38ddq4" path="res://audio/streams/voices/player/hups/hup_14.wav" id="7_faeet"]
[ext_resource type="PackedScene" uid="uid://bjpo451a0eupa" path="res://scenes/weapons/axe.tscn" id="7_wdg6b"]
[ext_resource type="AudioStream" uid="uid://diwl7b1646pt2" path="res://audio/streams/voices/player/hups/hup_15.wav" id="8_phu5y"]
[ext_resource type="AudioStream" uid="uid://c84847bf2ax0v" path="res://audio/streams/voices/player/hups/hup_16.wav" id="9_y5n02"]
[ext_resource type="AudioStream" uid="uid://b6hpblvhs0c4f" path="res://audio/streams/voices/player/hups/hup_17.wav" id="10_4nlgq"]
[ext_resource type="AudioStream" uid="uid://dkfsp11jb2re7" path="res://audio/streams/voices/player/hups/hup_18.wav" id="11_8wl43"]
[ext_resource type="PackedScene" uid="uid://wfllsui4k1if" path="res://scenes/effects/gibs/player_gibs.tscn" id="11_t14nv"]
[ext_resource type="AudioStream" uid="uid://c7nmgkuq6q1sw" path="res://audio/streams/voices/player/hups/hup_3.wav" id="12_bjjyo"]
[ext_resource type="AudioStream" uid="uid://d32mev28nulxc" path="res://audio/streams/voices/player/hups/hup_4.wav" id="13_pg18w"]
[ext_resource type="AudioStream" uid="uid://b8wlssmljrw50" path="res://audio/streams/voices/player/hups/hup_5.wav" id="14_gh54w"]
[ext_resource type="AudioStream" uid="uid://btd2d2qsxkhjo" path="res://audio/streams/voices/player/hups/hup_6.wav" id="15_gisw4"]
[ext_resource type="AudioStream" uid="uid://bmpwrksg7upyb" path="res://audio/streams/voices/player/hups/hup_7.wav" id="16_854b0"]
[ext_resource type="AudioStream" uid="uid://ccqxt72tfs7xh" path="res://audio/streams/voices/player/hups/hup_8.wav" id="17_r4lw8"]
[ext_resource type="AudioStream" uid="uid://cxjgdawg2i02r" path="res://audio/streams/voices/player/hups/hup_9.wav" id="18_hhbve"]
[ext_resource type="AudioStream" uid="uid://chxa831hh5rn7" path="res://audio/streams/voices/player/hups/hup_10.wav" id="19_xssea"]
[ext_resource type="Script" path="res://scripts/entities/player/weapon_manager.gd" id="21_ffg7x"]
[ext_resource type="Script" path="res://scripts/entities/player/game_container.gd" id="22_xo3e0"]
[ext_resource type="Script" path="res://scripts/entities/player/flashlight.gd" id="25_we7ax"]
[ext_resource type="Shader" path="res://shaders/canvas/post_process/cross_bloom.gdshader" id="26_rpeim"]
[ext_resource type="Script" path="res://scripts/entities/player/player_status.gd" id="28_ee1uu"]
[ext_resource type="AudioStream" path="res://audio/streams/voices/player/damage_placeholder.wav" id="32_2hkf1"]
[ext_resource type="Shader" path="res://shaders/spatial/cross_bloom_mesh.gdshader" id="33_60325"]
[ext_resource type="PackedScene" path="res://scenes/entities/stair_stepper.tscn" id="34_0co5b"]

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_ww5sc"]
random_pitch = 1.15
streams_count = 1
stream_0/stream = ExtResource("6_3oqj4")
stream_0/weight = 1.0

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_yxu58"]
random_pitch = 1.15
streams_count = 18
stream_0/stream = ExtResource("2_ltik2")
stream_0/weight = 1.0
stream_1/stream = ExtResource("3_6ae3o")
stream_1/weight = 1.0
stream_2/stream = ExtResource("12_bjjyo")
stream_2/weight = 1.0
stream_3/stream = ExtResource("13_pg18w")
stream_3/weight = 1.0
stream_4/stream = ExtResource("14_gh54w")
stream_4/weight = 1.0
stream_5/stream = ExtResource("15_gisw4")
stream_5/weight = 1.0
stream_6/stream = ExtResource("16_854b0")
stream_6/weight = 1.0
stream_7/stream = ExtResource("17_r4lw8")
stream_7/weight = 1.0
stream_8/stream = ExtResource("18_hhbve")
stream_8/weight = 1.0
stream_9/stream = ExtResource("19_xssea")
stream_9/weight = 1.0
stream_10/stream = ExtResource("4_tvufw")
stream_10/weight = 1.0
stream_11/stream = ExtResource("5_lnrhu")
stream_11/weight = 1.0
stream_12/stream = ExtResource("6_2r6q6")
stream_12/weight = 1.0
stream_13/stream = ExtResource("7_faeet")
stream_13/weight = 1.0
stream_14/stream = ExtResource("8_phu5y")
stream_14/weight = 1.0
stream_15/stream = ExtResource("9_y5n02")
stream_15/weight = 1.0
stream_16/stream = ExtResource("10_4nlgq")
stream_16/weight = 1.0
stream_17/stream = ExtResource("11_8wl43")
stream_17/weight = 1.0

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_2aq05"]
radius = 0.49

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_h4h3k"]
radius = 0.49
height = 1.0

[sub_resource type="SphereShape3D" id="SphereShape3D_wps46"]
radius = 0.45

[sub_resource type="CapsuleMesh" id="CapsuleMesh_iu3ba"]
radial_segments = 8
rings = 1

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_uyctv"]
random_pitch = 1.25
streams_count = 1
stream_0/stream = ExtResource("32_2hkf1")
stream_0/weight = 1.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7t8ki"]
shader = ExtResource("26_rpeim")
shader_parameter/intensity = 1.0
shader_parameter/threshold = 0.9
shader_parameter/spread = 12

[sub_resource type="GDScript" id="GDScript_rb3tb"]
script/source = "extends ColorRect


# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	Globals.settings_changed.connect(_on_globals_settings_changed)
	_on_globals_settings_changed()


func _on_globals_settings_changed() -> void:
	visible = Globals.s_cross_glow_enabled
"

[sub_resource type="AudioStreamRandomizer" id="AudioStreamRandomizer_d4n5i"]
random_pitch = 1.15
streams_count = 1
stream_0/stream = ExtResource("3_esyxp")
stream_0/weight = 1.0

[sub_resource type="BoxShape3D" id="BoxShape3D_jf2a8"]
size = Vector3(0.5, 0.5, 1)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_65bbo"]
render_priority = 0
shader = ExtResource("33_60325")
shader_parameter/intensity = 4.0
shader_parameter/threshold = 1.0
shader_parameter/spread = 8
shader_parameter/scale = 0.0

[sub_resource type="QuadMesh" id="QuadMesh_5eidy"]
custom_aabb = AABB(-1000, -1000, -1000, 2000, 2000, 2000)
flip_faces = true
size = Vector2(2, 2)

[sub_resource type="GDScript" id="GDScript_dlywb"]
script/source = "extends MeshInstance3D


# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	Globals.settings_changed.connect(_on_globals_settings_changed)
	_on_globals_settings_changed()


func _on_globals_settings_changed() -> void:
	visible = Globals.s_cross_glow_enabled
"

[node name="Player" type="CharacterBody3D"]
editor_description = "The player character."
collision_layer = 2
collision_mask = 5
script = ExtResource("1_30yaf")
speed = 15.0
acceleration = 50.0
max_speed = Vector3(1000, 10000, 1000)
slide_drag = 25.0
jump_height = 1.3
fall_grav = 14.7
slam_speed = 25.0
strafe_sway = 0.05
interact_stream = SubResource("AudioStreamRandomizer_ww5sc")
jump_stream = SubResource("AudioStreamRandomizer_yxu58")

[node name="PlayerHitbox" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_2aq05")

[node name="PlayerCrouchHitbox" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
shape = SubResource("CapsuleShape3D_h4h3k")
disabled = true

[node name="ClearanceCast" type="ShapeCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.75, 0)
shape = SubResource("SphereShape3D_wps46")
target_position = Vector3(0, 0.75, 0)
collision_mask = 21

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="."]
stream = SubResource("AudioStreamRandomizer_ww5sc")
bus = &"Player"

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
visible = false
layers = 2
cast_shadow = 0
mesh = SubResource("CapsuleMesh_iu3ba")

[node name="Status" type="Node" parent="."]
process_mode = 1
script = ExtResource("28_ee1uu")
injury_stream = SubResource("AudioStreamRandomizer_uyctv")
gib_threshold = 5000.0
gibs = ExtResource("11_t14nv")

[node name="StairStepper" parent="." instance=ExtResource("34_0co5b")]

[node name="Control" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2

[node name="CrossBloom" type="ColorRect" parent="Control"]
visible = false
material = SubResource("ShaderMaterial_7t8ki")
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
script = SubResource("GDScript_rb3tb")

[node name="HUD" parent="Control" instance=ExtResource("6_tw0uv")]
layout_mode = 1

[node name="SubViewportContainer" type="SubViewportContainer" parent="Control"]
z_index = -100
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
stretch = true
stretch_shrink = 2
script = ExtResource("22_xo3e0")

[node name="SubViewport" type="SubViewport" parent="Control/SubViewportContainer"]
handle_input_locally = false
canvas_item_default_texture_filter = 0
audio_listener_enable_3d = true
size = Vector2i(683, 384)
render_target_update_mode = 4

[node name="PlayerSync" type="Node3D" parent="Control/SubViewportContainer/SubViewport"]

[node name="PlayerCam" type="Camera3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync" groups=["player_cam"]]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.5, 0)
doppler_tracking = 2
current = true
fov = 120.0
far = 1000.0
script = ExtResource("21_ffg7x")
weapons = Array[Array]([[NodePath("Axe")], [NodePath("PumpShotgun")], [], [], [], [], []])
current_category = 1
ammo_types = {
"akm_bullets": 200,
"big_iron_bullets": 15,
"cells": 100,
"grenades": 25,
"nails": 100,
"rockets": 10,
"sawblades": 15,
"shells": 50
}

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam"]
stream = SubResource("AudioStreamRandomizer_d4n5i")
bus = &"Player"

[node name="Flashlight" type="SpotLight3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam"]
transform = Transform3D(0.996117, 0.0145506, 0.0868242, -0.00695469, 0.99617, -0.0871558, -0.0877598, 0.0862135, 0.992404, 0.2, -0.25, 0)
visible = false
layers = 2
light_color = Color(1, 0.831373, 0.501961, 1)
light_energy = 4.0
light_projector = ExtResource("6_eocyj")
light_bake_mode = 0
light_cull_mask = 4294967291
shadow_enabled = true
spot_range = 20.0
spot_attenuation = 0.333333
spot_angle = 35.0
script = ExtResource("25_we7ax")

[node name="AudioStreamPlayer" type="AudioStreamPlayer" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam/Flashlight"]
stream = SubResource("AudioStreamRandomizer_ww5sc")
volume_db = -2.5
bus = &"Player"

[node name="Interact" type="RayCast3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.5)
target_position = Vector3(0, 0, -4)
collision_mask = 61
hit_from_inside = true
collide_with_areas = true

[node name="Sightline" type="RayCast3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0.5)
target_position = Vector3(0, 0, -1000)
collision_mask = 61
hit_from_inside = true

[node name="ViewmodelAntiClip" type="Area3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.2, -0.75)
collision_layer = 2
collision_mask = 13
monitoring = false
monitorable = false

[node name="CollisionShape3D" type="CollisionShape3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam/ViewmodelAntiClip"]
shape = SubResource("BoxShape3D_jf2a8")

[node name="CrossBloom" type="MeshInstance3D" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, -1)
layers = 4
material_override = SubResource("ShaderMaterial_65bbo")
cast_shadow = 0
custom_aabb = AABB(-1000, -1000, -1000, 2000, 2000, 2000)
ignore_occlusion_culling = true
mesh = SubResource("QuadMesh_5eidy")
skeleton = NodePath("../../../../../..")
script = SubResource("GDScript_dlywb")

[node name="Axe" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam" instance=ExtResource("7_wdg6b")]

[node name="PumpShotgun" parent="Control/SubViewportContainer/SubViewport/PlayerSync/PlayerCam" instance=ExtResource("2_w8f7c")]
transform = Transform3D(-1, 0, -1.50996e-07, 0, 1, 0, 1.50996e-07, 0, -1, -0.15, -0.25, -0.35)
